{"version":3,"file":"_server.ts-69ff2177.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/pptr-api/get-tree.json/_server.ts.js"],"sourcesContent":["import * as puppeteer from \"puppeteer\";\nconst POST = async ({ request, setHeaders }) => {\n  const requestParams = await request.json();\n  const requestedUrl = requestParams.url;\n  console.log(`GET /getA11yTree for URL: `, requestedUrl, \"...\");\n  console.log(\"Fire up puppeteer ...\");\n  const browser = await puppeteer.launch();\n  const page = await browser.newPage();\n  await page.goto(requestedUrl, { waitUntil: \"domcontentloaded\" });\n  const accessibilityTreeSnapshot = await page.accessibility.snapshot();\n  let htmlLang = await page.evaluate(() => {\n    return document.querySelector(\"html\").getAttribute(\"lang\");\n  });\n  console.log(\"evaluate page finished,\", htmlLang);\n  if (htmlLang === null) {\n    htmlLang = \"\";\n  }\n  await browser.close();\n  console.log(\"Successful! Sending json response, language detected: ...\", htmlLang);\n  const response = { ...accessibilityTreeSnapshot };\n  response.htmlLangAttribute = htmlLang;\n  return new Response(JSON.stringify(response));\n};\nexport {\n  POST\n};\n"],"names":[],"mappings":";;AACK,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,UAAU,EAAE,KAAK;AAChD,EAAE,MAAM,aAAa,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AAC7C,EAAE,MAAM,YAAY,GAAG,aAAa,CAAC,GAAG,CAAC;AACzC,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,0BAA0B,CAAC,EAAE,YAAY,EAAE,KAAK,CAAC,CAAC;AACjE,EAAE,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;AACvC,EAAE,MAAM,OAAO,GAAG,MAAM,SAAS,CAAC,MAAM,EAAE,CAAC;AAC3C,EAAE,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,OAAO,EAAE,CAAC;AACvC,EAAE,MAAM,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,kBAAkB,EAAE,CAAC,CAAC;AACnE,EAAE,MAAM,yBAAyB,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC;AACxE,EAAE,IAAI,QAAQ,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,MAAM;AAC3C,IAAI,OAAO,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;AAC/D,GAAG,CAAC,CAAC;AACL,EAAE,OAAO,CAAC,GAAG,CAAC,yBAAyB,EAAE,QAAQ,CAAC,CAAC;AACnD,EAAE,IAAI,QAAQ,KAAK,IAAI,EAAE;AACzB,IAAI,QAAQ,GAAG,EAAE,CAAC;AAClB,GAAG;AACH,EAAE,MAAM,OAAO,CAAC,KAAK,EAAE,CAAC;AACxB,EAAE,OAAO,CAAC,GAAG,CAAC,2DAA2D,EAAE,QAAQ,CAAC,CAAC;AACrF,EAAE,MAAM,QAAQ,GAAG,EAAE,GAAG,yBAAyB,EAAE,CAAC;AACpD,EAAE,QAAQ,CAAC,iBAAiB,GAAG,QAAQ,CAAC;AACxC,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;AAChD;;;;"}